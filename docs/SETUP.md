# Setup Guide

## Prerequisites

- **Python 3.10+**
- **Node.js 18+** (for Pokemon Showdown server)
- **macOS / Linux** (Windows not tested)

---

## Installation

### 1. Clone Repository

```bash
git clone https://github.com/saketatreya/showdownRL.git
cd showdownRL
```

### 2. Create Virtual Environment

```bash
python3 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

### 3. Install Python Dependencies

```bash
pip install -r requirements.txt
```

### 4. Clone Pokemon Showdown

The Showdown server is **not included** in this repo (too large). Clone it separately:

```bash
git clone https://github.com/smogon/pokemon-showdown.git
cd pokemon-showdown
npm install
cd ..
```

---

## Running the Server

Start the local Showdown server:

```bash
# Option 1: Using the helper script
./start_server.sh

# Option 2: Manual
cd pokemon-showdown
node pokemon-showdown start --no-security
```

The server runs on `localhost:8000` by default.

---

## Training

### Basic Training

```bash
# 8 parallel environments, 1M timesteps
python scripts/train.py --n-envs 8 --total-timesteps 1000000
```

### With Potential-Based Reward Shaping

First train the win predictor (requires replay data):

```bash
# Scrape replays (optional, if you need fresh data)
python scripts/scrape_replays.py --target-count 10000 --min-rating 1300

# Train win predictor
python scripts/train_predictor.py

# Train RL agent with potential shaping
python scripts/train.py --reward-shaping potential --n-envs 8
```

---

## Data Directories

These are **not tracked by git** (too large):

| Directory | Purpose | How to Obtain |
|-----------|---------|---------------|
| `data/replays/` | Showdown replay JSONs | `python scripts/scrape_replays.py` |
| `data/cache_chunks/` | Preprocessed training data | Auto-generated by `train_predictor.py` |
| `models/` | Trained model weights | Generated during training |

---

## Troubleshooting

### Server won't start
- Ensure Node.js is installed: `node --version`
- Check if port 8000 is in use: `lsof -i :8000`

### Training crashes immediately
- Ensure server is running: `curl http://localhost:8000`
- Check Python environment: `which python` should show venv path

### Out of memory during training
- Reduce `--n-envs` (try 4 instead of 8)
- For win predictor: data is chunked to disk automatically
